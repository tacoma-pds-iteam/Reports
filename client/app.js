"use strict";var _createClass=function(){function a(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(e,t,r){return t&&a(e.prototype,t),r&&a(e,r),e}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Display=function(){function t(e){_classCallCheck(this,t),this.tableObj=e,this.generation(this.tableObj)}return _createClass(t,[{key:"infoSet",value:function(e,t){$("#report-info-container").children().hide(),$("#report-info-main").show();var r=this.reportFind(e,t);this.generateInfo(r),this.generateAdvInfo(r,"Parameters")}},{key:"reportFind",value:function(e,t){var r=void 0,a=this.tableObj;if(a)for(var n=0;n<a.length;n++)e==a[n]._name&&t==a[n]._version&&(r=a[n]);return r}},{key:"generation",value:function(e){var t=this.getCategories(e);this.generateMenu(t),this.generateTable(t,e)}},{key:"getCategories",value:function(e){var t=[];if(e)for(var r=0;r<e.length;r++)0==t.includes(e[r]._categories[0])&&t.push(e[r]._categories[0]);return t.sort(),t}},{key:"generateMenu",value:function(e){var t="\n      <div class='menu-option'>\n        <p>All Reports</p>\n      </div>";if(e)for(var r=0;r<e.length;r++)t+="<div class='menu-option'>\n            <p>"+e[r]+"</p>\n          </div>";t+="<div class='menu-option'>\n        <p>Deprecated</p>\n      </div>",$("#menu-choices").html(t)}},{key:"generateTable",value:function(e,t){t.sort(this.sorter("_publishDate"));var r="";if(e){for(var a=0;a<e.length;a++){if(r+="\n          <div id='"+e[a].replace(/[ ,]+/g,"-").toLowerCase()+"'>\n          <div class='table-header'>\n            "+e[a]+"\n          </div>\n          <div class='table-content'>\n            <table>\n              <thead>\n                <tr>\n                  <th width='30%'><div style='text-align:left' class='table-cat-sort'>Report Name</div></th>\n                  <th class='table-cat-sort'>Version</th>\n                  <th class='table-cat-sort'>Parameters</th>\n                  <th class='table-cat-sort'>Request Date</th>\n                  <th class='table-cat-sort'>Requester</th>\n                  <th class='table-cat-sort'>Publish Date</th>\n                  <th width='10%' ><div style='text-align:center'>Link</div></th>\n                </tr>\n              </thead>\n              <tbody>",t)for(var n=0;n<t.length;n++)e[a]==t[n]._categories[0]&&"N"==t[n]._deprecated&&(r+="\n              <tr class='table-rpt-option'>\n                <td class='rpt-click rpt-name'><div style='text-align:left'>"+t[n]._name+"</div></td>\n                <td class='rpt-click rpt-ver'>"+t[n]._version+"</td>\n                <td class='rpt-click'>"+t[n]._paramsCount+"</td>\n                <td class='rpt-click'>"+t[n]._requestDate+"</td>\n                <td class='rpt-click'>"+t[n]._requester+"</td>\n                <td class='rpt-click'>"+t[n]._publishDate+"</td>\n                <td><button type='button' class='rpt-link' onclick=\"window.open('"+t[n]._link+'\')"><i class="fas fa-link"></i></button></td>\n              </tr>\n              ');r+="\n                </tbody>\n              </table>\n            </div>\n          </div>\n          </div>"}if(r+="\n      <div id='deprecated'>\n      <div class='table-header'>\n        Deprecated\n      </div>\n      <div class='table-content'>\n        <table>\n          <thead>\n            <tr>\n              <th width='30%'><div style='text-align:left'>Report Name</div></th>\n              <th width=''>Version</th>\n              <th width=''>Parameters</th>\n              <th width=''>Request Date</th>\n              <th width=''>Requester</th>\n              <th width=''>Publish Date</th>\n              <th width='10%' ><div style='text-align:center'>Link</div></th>\n            </tr>\n          </thead>\n          <tbody>",t)for(var i=0;i<t.length;i++)"Y"==t[i]._deprecated&&(r+="\n            <tr class='table-rpt-option'>\n              <td class='rpt-click rpt-name'><div style='text-align:left'>"+t[i]._name+"</div></td>\n              <td class='rpt-click rpt-ver'>"+t[i]._version+"</td>\n              <td class='rpt-click'>"+t[i]._paramsCount+"</td>\n              <td class='rpt-click'>"+t[i]._requestDate+"</td>\n              <td class='rpt-click'>"+t[i]._requester+"</td>\n              <td class='rpt-click'>"+t[i]._publishDate+"</td>\n              <td><button type='button' class='rpt-link' onclick=\"window.open('"+t[i]._link+'\')"><i class="fas fa-link"></i></button></td>\n            </tr>\n            ');r+="\n              </tbody>\n            </table>\n          </div>\n        </div>"}$("#table-search").hide(),$(".search-text").val(""),$("#limiter").html(r).show(),$("#deprecated").hide()}},{key:"generateInfo",value:function(e){var t=e._name,r=e._version,a=e._categories,n=""!=e._publishDate?e._publishDate:"Not Available",i=""!=e._requestDate?e._requestDate:"Not Available",o=""!=e._requester?e._requester:"Not Available",s="N/A"!=e._description?e._description:"No Description Available",l=e._link,c=e._formats,d='\n      <span id="rpt-name"><i class="fas fa-edit"></i> '+t+'</span>\n      <span id="rpt-version">v.'+r+"</span>";$("#report-info-name").html(d),$("#report-publish-date").html(n),$("#report-request-date").html(i),$("#report-requester").html(o),$("#report-categories").html(a.join(", ")),$("#report-description").html(s);var h="<h3>Report Links:</h3><a href='"+l+"' target='_blank'>Direct Link</a>",p=0,u=void 0;if(c)for(var v=0;v<c.length;v++)"CSV"==c[v]?p="8":"PDF"==c[v]?p="5":"Excel"==c[v]&&(p="6"),u=l+"&export=true&exporttype=",h+="<a href='"+(u+=p)+"' target='_blank'>"+c[v]+"</a>";$("#report-links").html(h)}},{key:"generateAdvInfo",value:function(e,t){var r="";if("Parameters"==t){this.AdvInfoButtonToggle(0);var a=e._paramsSplit,n=[];for(var i in a){var o=a[i].split(":");1<o.length&&(a[i]=o[0],n.push(o[1]))}if(a)for(var s=0;s<a.length;s++)"N/A"!=a[s]?(r+="<tr><td width='50%'>"+a[s]+"</td><td width='50%'>",n[s]&&n.length<=s+1?r+=""+n[s]:r+="N/A",r+="</td></tr>"):r="<tr><td>No Input Parameters</td></tr>";else r="<tr><td>No Input Parameters</td></tr>"}if("Fields"==t){this.AdvInfoButtonToggle(1);var l=e._fields;if(l)for(var c=0;c<l.length;c++)"N/A"!=l[c]?r+="<tr><td>"+l[c]+"</td></tr>":r="<tr><td>No Fields Indicated</td></tr>";else r="<tr><td>No Fields Indicated</td></tr>"}if("Filters"==t){this.AdvInfoButtonToggle(2);var d=e._filters;if(d)for(var h=0;h<d.length;h++)"N/A"!=d[h]?r+="<tr><td>"+d[h]+"</td></tr>":r="<tr><td>No Filters on report</td></tr>";else r="<tr><td>No Filters on report</td></tr>"}$("#report-adv-generation").html(r)}},{key:"generateGlobalSearch",value:function(e){var t=this.tableObj,r=void 0,a=[],n=void 0,i=0;r=e?e.toLowerCase().toString():null;for(var o=0;o<t.length;o++)-1!==(n=[t[o]._name,t[o]._version,t[o]._description,t[o]._requester])[0].toLowerCase().indexOf(r)?a.push(n):-1!==n[1].toLowerCase().indexOf(r)?a.push(n):-1!==n[2].toLowerCase().indexOf(r)?a.push(n):-1!==n[3].toLowerCase().indexOf(r)&&a.push(n);0<a.length&&(i=a.length);var s="\n      <div class='table-header'>\n        "+i+" search results\n      </div>\n      <div id='search-results-container'>";if(0<a.length)for(var l=0;l<a.length;l++)s+="\n          <div class='search-result'>\n            <span class='rpt-searcher'>"+a[l][0]+":"+a[l][1]+"</span>\n            <div class='search-title'>"+(l+1)+". "+a[l][0]+"</div>\n            <div><b>Version:</b> "+a[l][1]+"</div>\n            <div><b>Requester:</b> "+a[l][3]+"</div>\n            <div><b>Description:</b><br> "+a[l][2]+"</div>\n          </div>\n          ";s+="</div>",$("#limiter").hide(),$("#table-search").show(),$("#table-search").html(s)}},{key:"AdvInfoButtonToggle",value:function(e){$("#report-info-label").children(".adv-info-btn").removeClass("active-tab"),$("#report-info-label").children(".adv-info-btn")[e].className="adv-info-btn active-tab"}},{key:"sorter",value:function(n){return function(e,t){var r=e[n],a=t[n];return""==r?1:(r.includes("/")&&(r=new Date(r)),a.includes("/")&&(a=new Date(a)),r<a?1:r<a?-1:0)}}}]),t}(),Entry=function(){function u(e,t,r,a,n,i,o,s,l,c,d,h,p){_classCallCheck(this,u),this._name=e||"Should Never Occur",this._version=t||"Should Never Occur",this._publishDate=r||"",this._requestDate=a||"",this._requester=n||"",this._params=i||"",this._description=o||"N/A",this._link=s||"",this._filter=l||"",this._field=c||"",this._category=h||"Should Never Occur",this._format=d,this._deprecated=p,this._paramsSplit=this.splitter(this._params),this._paramsDescSplit=this.splitter(this._paramsDesc),this._filters=this.splitter(this._filter),this._fields=this.splitter(this._field),this._categories=this.splitter(this._category),this._formats=this.splitter(this._format),this._paramsCount=this.counter(this._paramsSplit)}return _createClass(u,[{key:"splitter",value:function(e){if(e)try{return e.split("|")}catch(e){console.log(e)}}},{key:"counter",value:function(e){return e?e.length:0}}]),u}(),Controller=function(){function t(e){_classCallCheck(this,t),this.document=document,this.dbData=[],this.display,this.getData(e),this.getDisplay()}return _createClass(t,[{key:"getData",value:function(e){var a=this;e.forEach(function(e){for(var t in e)null==e[t]&&(e[t]="");var r=new Entry(e.report_name.toString(),e.version.toString(),e.publish_date.toString(),e.request_date.toString(),e.requester.toString(),e.parameters.toString(),e.description.toString(),e.link.toString(),e.filters.toString(),e.fields.toString(),e.formats.toString(),e.category.toString(),e.deprecated.toString());a.dbData.push(r)})}},{key:"createNewReport",value:function(e){var t=$(".export-choice.selected-choice"),r=[];t.each(function(e){r.push($(t[e]).text().replace(/\s/g,""))}),r=r.join("|");var a=$(".param-input"),n=$(".param-desc-input"),i=[];a.each(function(e){if(""==a[e].value)return!0;""!=n[e].value?i.push(a[e].value+":"+n[e].value):i.push(a[e].value)}),i=i.join("|");var o=$("#new-name").val();e.emit("deprecate-reports",o);var s={report_name:o,version:$("#new-version").val(),parameters:i,request_date:$("#new-reqdate").val(),requester:$("#new-requester").val(),publish_date:$("#new-pubdate").val(),category:$("#new-category").val(),fields:$("#new-fields").val(),filters:$("#new-filters").val(),description:$("#new-desc").val(),formats:r,link:$("#new-link").val(),deprecated:"N"};s.report_name||($("#new-name").attr("placeholder","*Report Name is Required*"),$("#new-name").addClass("required-field")),s.version||($("#new-version").attr("placeholder","*Version is Required*"),$("#new-version").addClass("required-field")),s.category||($("#new-category").attr("placeholder","*Category is Required*"),$("#new-category").addClass("required-field")),s.report_name&&s.version&&s.category?(console.log("Generating New Report"),e.emit("create-report",s),this.reportModal()):console.log("Data not entered correctly"),console.log(s)}},{key:"updateReport",value:function(e){var t={report_name:$("#new-name").val(),version:$("#new-version").val(),parameters:$("#new-params").val(),request_date:$("#new-reqdate").val(),requester:$("#new-requester").val(),publish_date:$("#new-pubdate").val(),category:$("#new-category").val(),fields:$("#new-fields").val(),filters:$("#new-filters").val(),description:$("#new-desc").val(),exports:$("#new-exports").val(),link:$("#new-link").val(),deprecated:"N"};t.report_name||($("#new-name").attr("placeholder","*Report Name is Required*"),$("#new-name").addClass("required-field")),t.version||($("#new-version").attr("placeholder","*Version is Required*"),$("#new-version").addClass("required-field")),t.category||($("#new-category").attr("placeholder","*Category is Required*"),$("#new-category").addClass("required-field")),t.report_name&&t.version&&t.category?(console.log("Generating New Report"),e.emit("update-report",t),this.reportModal()):console.log("Data not entered correctly"),console.log(t)}},{key:"resetModal",value:function(){$("#new-name").prop("disabled",!1),$("#new-version").prop("disabled",!1),$("#new-name").removeClass("required-field"),$("#new-version").removeClass("required-field"),$("#new-category").removeClass("required-field"),$("#new-name").attr("placeholder","Report Name"),$("#new-version").attr("placeholder","Version"),$("#new-category").attr("placeholder","Category"),$(".export-choice").removeClass("selected-choice"),$("#new-name").val(""),$("#new-version").val(""),$("#new-reqdate").val(""),$("#new-requester").val(""),$("#new-pubdate").val(""),$("#new-category").val(""),$("#new-fields").val(""),$("#new-filters").val(""),$("#new-desc").val(""),$("#new-link").val("");for(var e=2;e<=5;e++)$(".name-"+e).hide(),$(".desc-"+e).hide();$(".param-input").val(""),$(".param-desc-input").val(""),$("#create-rpt-submit").show(),$("#update-rpt-submit").hide()}},{key:"getDisplay",value:function(){try{this.display=new Display(this.dbData)}catch(e){console.log(e)}}},{key:"reportSelect",value:function(e){var t=e.parents().children(".rpt-name").text().trim(),r=e.parents().children(".rpt-ver").text();this.display.infoSet(t,r)}},{key:"searchSelect",value:function(e){var t=e.parents().children(".rpt-searcher").text();t=t.split(":"),this.display.infoSet(t[0],t[1])}},{key:"advInfoChange",value:function(e){var t=e.parents("#report-adv-info").siblings("#report-info-name"),r=t.children("#rpt-name").text().trim(),a=t.children("#rpt-version").text().split("v."),n=this.display.reportFind(r,a[1]),i=e.children().text();this.display.generateAdvInfo(n,i)}},{key:"categorySelect",value:function(e){$("#table-search").hide(),$("#limiter").show();var t=e.children().text();"all-reports"==(t=t.replace(/[ ,]+/g,"-").toLowerCase())?($("#limiter").children().show(),$("#deprecated").hide()):"deprecated"==t?($("#limiter").children().hide(),$("#deprecated").show()):($("#limiter").children().hide(),$("#"+t).show())}},{key:"reportTabSwitch",value:function(e){var t=""==$("#report-info-name").text(),r=e[0].innerText;$("#report-info-container").children().hide(),"Advanced Search"==r?$("#advanced-search").show():"Report"==r?t?$("#report-placeholder").show():$("#report-info-main").show():"Instructions"==r&&$("#report-instructions").show()}},{key:"reportModal",value:function(){this.resetModal();var e=$("#modal-container");e.hasClass("hide-modal")?e.removeClass("hide-modal"):e.addClass("hide-modal")}},{key:"updateModal",value:function(e){var t=e.parents("#report-info-name"),r=t.children("#rpt-name").text().trim(),a=t.children("#rpt-version").text().split("v.")[1],n=this.display.reportFind(r,a),i=$("#modal-container"),o=n._params.split("|"),s=n._formats;i.hasClass("hide-modal")?i.removeClass("hide-modal"):i.addClass("hide-modal"),$.each(n,function(e,t){"N/A"==t&&(n[e]="")}),$("#create-rpt-submit").hide(),$("#update-rpt-submit").show(),$("#new-name").prop("disabled",!0),$("#new-version").prop("disabled",!0),$("#new-name").val(n._name),$("#new-version").val(n._version),$("#new-category").val(n._category),$("#new-reqdate").val(n._requestDate),$("#new-requester").val(n._requester),$("#new-pubdate").val(n._publishDate),$("#new-fields").val(n._field),$("#new-filters").val(n._filter),$("#new-desc").val(n._description),$("#new-link").val(n._link),$.each(o,function(e,t){var r=t.split(":");$(".param-input.name-"+(e+1)).val(r[0]).show(),$(".param-desc-input.desc-"+(e+1)).val(r[1]).show()}),$.each(s,function(e,t){$(".export-choice."+t.toLowerCase()).addClass("selected-choice")})}},{key:"search",value:function(){var e=$(".search-text").val();this.display.generateGlobalSearch(e)}},{key:"advancedSearch",value:function(){console.log("Decided to skip feature, leaving blank space in case wanted at a later point")}},{key:"addParameter",value:function(e){var t=$(".param-input:visible").length+1;t<=5?($("#fa-changer").css("transform","rotate(45deg)"),setTimeout(function(){$("#fa-changer").css("transform","rotate(90deg)")},500),$(".name-"+t).show(),$(".desc-"+t).show()):console.log("Max Params")}},{key:"tableSort",value:function(e){var t=e.text();"Report Name"==t&&(t="_name"),"Version"==t&&(t="_version"),"Parameters"==t&&(t="_params"),"Request Date"==t&&(t="_requestDate"),"Requester"==t&&(t="_requester"),"Publish Date"==t&&(t="_publishDate")}}]),t}(),Main=function e(t){var r=this;_classCallCheck(this,e),t.on("connect",function(){console.log("Connected to Server!")}),t.on("disconnect",function(){console.log("Disconnected from Server!")}),t.on("report-data",function(e){r.controller=new Controller(e)})};!function(e){var t=io({reconnection:!1,reconnectionAttempts:1,reconnectionDelay:1e3,reconnectionDelayMax:5e3});$("body").on("click",".adv-info-btn",function(e){r.controller.advInfoChange($(this))}),$("body").on("click",".rpt-click",function(e){r.controller.reportSelect($(this))}),$("body").on("click",".fa-edit",function(e){r.controller.updateModal($(this))}),$("body").on("click",".menu-option",function(e){r.controller.categorySelect($(this))}),$(".report-modal").click(function(e){r.controller.reportModal()}),$(".search-text").keyup(function(e){r.controller.search()}),$("#create-rpt-submit").click(function(e){r.controller.createNewReport(t)}),$("#update-rpt-submit").click(function(e){r.controller.updateReport(t)}),$("body").on("click",".search-title",function(e){r.controller.searchSelect($(this))}),$(".reload-page").click(function(e){location.reload()}),$("body").on("click","#new-param-button",function(e){r.controller.addParameter($(this))}),$(".export-choice").click(function(e){$(this).toggleClass("selected-choice")}),$("body").on("click",".table-cat-sort",function(e){r.controller.tableSort($(this))}),$(".easter-egg").click(function(e){$("body").hasClass("haha")?$("body").rotate(0):$("body").rotate(180),$("body").toggleClass("haha")});var r=new Main(t)}(),jQuery.fn.rotate=function(e){$(this).css({"-webkit-transform":"rotate("+e+"deg)","-moz-transform":"rotate("+e+"deg)","-ms-transform":"rotate("+e+"deg)",transform:"rotate("+e+"deg)"}),0==e?$(this).css("margin-top","0px"):$(this).css("margin-top","-60px")};